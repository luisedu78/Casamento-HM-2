<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Confirmar Presen√ßa ‚Äî Marilia & Huesley</title>
  <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
  <nav>
  <div class="container inner">
    <div class="brand"><span class="badge">M ‚ô• H</span> Marilia &amp; Huesley</div>
    <button class="nav-toggle" aria-label="Abrir menu" aria-expanded="false" aria-controls="menu">‚ò∞</button>
<div class="menu" id="menu">
      <a href="index.html" >In√≠cio</a>
      <a href="cerimonia.html" >Cerim√¥nia</a>
      <a href="presentes.html" >Presentes</a>
      <a class="button primary" href="rsvp.html">Confirmar Presen√ßa</a>
    </div>
  </div>
</nav>
  <main class="section">
    <div class="container">
      <h2>Confirme sua Presen√ßa</h2>
      <form id="rsvp-form" class="grid" style="grid-template-columns:1fr 1fr; gap:16px; max-width:720px;">
        <label>Nome completo<br><input name="nome" required style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;"></label>
        <label>Vai ao casamento?<br>
          <select name="vai" required style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;">
            <option value="sim">Sim</option>
            <option value="nao">N√£o</option>
          </select>
        </label>
        <label>Adultos<br><input name="adultos" type="number" min="0" value="1" required style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;"></label>
        <label>Crian√ßas<br><input name="criancas" type="number" min="0" value="0" required style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;"></label>
        <label>E-mail<br><input name="email" type="email" required style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;"></label>
        <label>WhatsApp<br><input name="whats" type="tel" placeholder="(00) 00000-0000" style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;"></label>
        <label style="grid-column:1 / -1;">Observa√ß√µes<br><textarea name="obs" rows="4" style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;"></textarea></label>
        <div style="grid-column:1 / -1; display:flex; gap:12px; align-items:center;">
          <input id="lgpd" type="checkbox" required>
          <label for="lgpd">Autorizo o uso dos meus dados para organiza√ß√£o do evento (LGPD).</label>
        </div>
        <button class="button primary" type="submit" style="grid-column:1 / -1; width:fit-content;">Enviar confirma√ß√£o</button>
      
        <div id="rsvp-actions" class="card" style="margin-top:12px; padding:12px; display:flex; gap:10px; flex-wrap:wrap;">
          <button type="button" id="btn-whatsapp" class="button">Enviar por WhatsApp</button>
          <button type="button" id="btn-forms" class="button outline">Enviar pelo Formul√°rio</button>
          <p id="rsvp-hint" class="subtitle" style="margin:0 0 0 10px; opacity:.75;">Preencha os campos acima e escolha uma op√ß√£o.</p>
        </div>
      </form>
        
      <p id="rsvp-ok" style="display:none; margin-top:16px;" class="subtitle">Obrigado! Sua resposta foi registrada.</p>
    </div>
  </main>
  <footer class="footer">
  <div class="container">
    todos os direitos reservados ¬Æ
  </div>
</footer>
  <script  src="assets/app.js"></script>

  <div id="cookie-toast" class="cookie-toast" role="dialog" aria-live="polite">
    <div class="row">
      <svg class="cookie-ico" viewBox="0 0 24 24" fill="#C57C3D" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M21 12a9 9 0 1 1-9-9c.5 0 1 .04 1.47.12a3 3 0 0 0 3.99 3.99c.08.47.12.97.12 1.47A3 3 0 0 0 21 12Z"/><circle cx="9" cy="10" r="1.2" fill="#6B3D1E"/><circle cx="12.5" cy="7.5" r="1" fill="#6B3D1E"/><circle cx="14.5" cy="12.5" r="1.1" fill="#6B3D1E"/><circle cx="10.5" cy="14.5" r="0.9" fill="#6B3D1E"/></svg>
      <div style="flex:1">
        <strong>Cookies</strong><br>
        Usamos cookies essenciais para melhorar sua experi√™ncia.
      </div>
    </div>
    <div class="actions">
      <button id="cookie-accept" class="button primary" style="padding:8px 12px;">Aceitar</button>
      <button id="cookie-decline" class="button ghost" style="padding:8px 12px;">Recusar</button>
    </div>
  </div>


<script>
document.addEventListener('DOMContentLoaded', function(){
  const form = document.getElementById('rsvp-form');
  const btnW = document.getElementById('btn-whatsapp');
  const btnF = document.getElementById('btn-forms');

  async function loadCfg(){
    try{
      const res = await fetch('assets/site.config.json', {cache:'no-store'});
      if(!res.ok) return null;
      return await res.json();
    }catch(e){ return null; }
  }

  function getVal(name){
    const el = form.querySelector(`[name="${name}"]`);
    return el ? (el.value || '') : '';
  }

  function buildMessage(){
    const nome = getVal('nome');
    const qtd = getVal('qtd') || '1';
    const presenca = getVal('presenca');
    const msg = getVal('msg');
    const partes = [];
    partes.push(`Ol√°, sou ${nome}! üíçüéâ`);
    if(presenca) partes.push(`Resposta: ${presenca}`);
    partes.push(`Quantidade de pessoas: ${qtd}`);
    if(msg) partes.push(`Mensagem: ${msg}`);
    return partes.join('\n');
  }

  if(btnW){
    btnW.addEventListener('click', async ()=>{
      if(!form) return;
      const cfg = await loadCfg();
      const phone = (cfg && cfg.coupleWhatsapp || '').replace(/[^\d]/g,'');
      if(!phone){
        alert('O n√∫mero de WhatsApp ainda n√£o foi configurado.');
        return;
      }
      const texto = encodeURIComponent(buildMessage());
      window.open(`https://wa.me/${phone}?text=${texto}`, '_blank');
    });
  }

  if(btnF){
    btnF.addEventListener('click', async ()=>{
      const cfg = await loadCfg();
      const url = cfg && cfg.formsUrl;
      if(!url){
        alert('O link do Google Forms ainda n√£o foi configurado.');
        return;
      }
      // Abre o Forms pr√©-preenchido (pp_url). Para avan√ßar: podemos tamb√©m montar parametros entry.xxxx aqui.
      window.open(url, '_blank');
    });
  }
});
</script>

</body>
</html>