<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Confirmar Presen√ßa ‚Äî Marilia & Huesley</title>
  <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
  <nav>
  <div class="container inner">
    <div class="brand"><span class="badge">M ‚ô• H</span> Marilia &amp; Huesley</div>
    <button class="nav-toggle" aria-label="Abrir menu" aria-expanded="false" aria-controls="menu">‚ò∞</button>
<div class="menu" id="menu">
      <a href="index.html" >In√≠cio</a>
      <a href="cerimonia.html" >Cerim√¥nia</a>
      <a href="presentes.html" >Presentes</a>
      <a class="button primary" href="rsvp.html">Confirmar Presen√ßa</a>
    </div>
  </div>
</nav>
  <main class="section">
    <div class="container">
      <h2>Confirme sua Presen√ßa</h2>
      <form id="rsvp-form" class="grid" style="grid-template-columns:1fr 1fr; gap:16px; max-width:720px;">
        <label>Nome completo<br><input name="nome" required style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;"></label>
        <label>Vai ao casamento?<br>
          <select name="vai" required style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;">
            <option value="sim">Sim</option>
            <option value="nao">N√£o</option>
          </select>
        </label>
        <label>Adultos<br><input name="adultos" type="number" min="0" value="1" required style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;"></label>
        <label>Crian√ßas<br><input name="criancas" type="number" min="0" value="0" required style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;"></label>
        <label>E-mail<br><input name="email" type="email" required style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;"></label>
        <label>WhatsApp<br><input name="whats" type="tel" placeholder="(00) 00000-0000" style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;"></label>
        <label style="grid-column:1 / -1;">Observa√ß√µes<br><textarea name="obs" rows="4" style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;"></textarea></label>
        <div style="grid-column:1 / -1; display:flex; gap:12px; align-items:center;">
          <input id="lgpd" type="checkbox" required>
          <label for="lgpd">Autorizo o uso dos meus dados para organiza√ß√£o do evento (LGPD).</label>
        </div>
        <button class="button primary" type="submit" style="grid-column:1 / -1; width:fit-content;">Enviar confirma√ß√£o</button>
      
        <div id="rsvp-actions" class="card" style="margin-top:12px; padding:12px; display:flex; gap:10px; flex-wrap:wrap;">
          <button type="button" id="btn-whatsapp" class="button" style="background:#25D366;border-color:#25D366">Confirmar pelo WhatsApp</button>
          <p id="rsvp-hint" class="subtitle" style="margin:0; opacity:.75;">O envio registra silenciosamente no formul√°rio e abre o WhatsApp.</p>
        </div>
      </form>
        
      <p id="rsvp-ok" style="display:none; margin-top:16px;" class="subtitle">Obrigado! Sua resposta foi registrada.</p>
    </div>
  </main>
  <footer class="footer">
  <div class="container">
    todos os direitos reservados ¬Æ
  </div>
</footer>
  <script  src="assets/app.js"></script>

  <div id="cookie-toast" class="cookie-toast" role="dialog" aria-live="polite">
    <div class="row">
      <svg class="cookie-ico" viewBox="0 0 24 24" fill="#C57C3D" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M21 12a9 9 0 1 1-9-9c.5 0 1 .04 1.47.12a3 3 0 0 0 3.99 3.99c.08.47.12.97.12 1.47A3 3 0 0 0 21 12Z"/><circle cx="9" cy="10" r="1.2" fill="#6B3D1E"/><circle cx="12.5" cy="7.5" r="1" fill="#6B3D1E"/><circle cx="14.5" cy="12.5" r="1.1" fill="#6B3D1E"/><circle cx="10.5" cy="14.5" r="0.9" fill="#6B3D1E"/></svg>
      <div style="flex:1">
        <strong>Cookies</strong><br>
        Usamos cookies essenciais para melhorar sua experi√™ncia.
      </div>
    </div>
    <div class="actions">
      <button id="cookie-accept" class="button primary" style="padding:8px 12px;">Aceitar</button>
      <button id="cookie-decline" class="button ghost" style="padding:8px 12px;">Recusar</button>
    </div>
  </div>


<script>
document.addEventListener('DOMContentLoaded', function(){
  const form = document.getElementById('rsvp-form');
  const btnW = document.getElementById('btn-whatsapp');
  const FORM_ACTION = "https://docs.google.com/forms/d/e/1FAIpQLSfM0wf2ZkxSMrnpFeMuejjVMBMaJNGZzZxwn5GfnhHKHS3C5A/formResponse";
  const WHATS = "5541998022655";
  const ENTRY = {
    nome: "entry.1613779454",
    presenca: "entry.218794958",
    adultos: "entry.58451838",
    criancas: "entry.117818860",
    email: "entry.1056036298",
    telefone: "entry.1722004759",
    msg: "entry.1437778774"
  };

  function getVal(name){
    const el = form ? form.querySelector(`[name="${name}"]`) : null;
    return el ? (el.value || '') : '';
  }
  function toInt(v, d){ const n = parseInt(v, 10); return isNaN(n) ? (d||0) : n; }
  function buildWhatsText(){
    const nome = getVal('nome');
    const email = getVal('email');
    const tel = getVal('telefone');
    const presenca = getVal('presenca');
    const adultos = toInt(getVal('adultos'), 0);
    const criancas = toInt(getVal('criancas'), 0);
    const total = adultos + criancas;
    const msg = getVal('msg');
    const lines = [];
    lines.push(`Ol√°, sou ${nome}! üíçüéâ`);
    lines.push(`Resposta: ${presenca||'-'}`);
    lines.push(`üë§ Adultos: ${adultos} | üë∂ Crian√ßas: ${criancas} | üë• Total: ${total}`);
    lines.push(`üìß E-mail: ${email||'-'}`);
    lines.push(`üìû Telefone: ${tel||'-'}`);
    if (msg) lines.push(`üí¨ Mensagem: ${msg}`);
    return encodeURIComponent(lines.join('\n'));
  }
  async function sendToFormsSilently(){
    const payload = new URLSearchParams();
    payload.append(ENTRY.nome, getVal('nome'));
    payload.append(ENTRY.presenca, getVal('presenca'));
    payload.append(ENTRY.adultos, getVal('adultos'));
    payload.append(ENTRY.criancas, getVal('criancas'));
    payload.append(ENTRY.email, getVal('email'));
    payload.append(ENTRY.telefone, getVal('telefone'));
    payload.append(ENTRY.msg, getVal('msg'));
    try {
      await fetch(FORM_ACTION, { method:'POST', mode:'no-cors', headers:{'Content-Type':'application/x-www-form-urlencoded'}, body: payload });
    } catch(e) { console.warn('Falha no envio silencioso ao Forms (ok em no-cors):', e); }
  }
  if (btnW){
    btnW.addEventListener('click', async () => {
      if (!form) return;
      if (!getVal('nome') || !getVal('presenca')) { alert('Preencha pelo menos Nome e Presen√ßa.'); return; }
      await sendToFormsSilently();
      const texto = buildWhatsText();
      if (!WHATS) return alert('N√∫mero de WhatsApp n√£o configurado.');
      window.open(`https://wa.me/${WHATS}?text=${texto}`, '_blank');
      const ok = document.getElementById('rsvp-ok');
      if (ok) ok.style.display = 'block';
      form.reset();
    });
  }
});
</script>

</body>
</html>